<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>搭建Xray证书自动续期</title>
      <link href="/2024/08/07/%E6%90%AD%E5%BB%BAXray%E8%AF%81%E4%B9%A6%E8%87%AA%E5%8A%A8%E7%BB%AD%E6%9C%9F/"/>
      <url>/2024/08/07/%E6%90%AD%E5%BB%BAXray%E8%AF%81%E4%B9%A6%E8%87%AA%E5%8A%A8%E7%BB%AD%E6%9C%9F/</url>
      
        <content type="html"><![CDATA[<div class="video-container">[up主专用，视频内嵌代码贴在这]</div><style>.video-container {    position: relative;    width: 100%;    padding-top: 56.25%; /* 16:9 aspect ratio (height/width = 9/16 * 100%) */}.video-container iframe {    position: absolute;    top: 0;    left: 0;    width: 100%;    height: 100%;}</style><hr>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>docker搭建个人博客Wordpress</title>
      <link href="/2024/08/07/docker%E6%90%AD%E5%BB%BA%E4%B8%AA%E4%BA%BA%E5%8D%9A%E5%AE%A2Wordpress/"/>
      <url>/2024/08/07/docker%E6%90%AD%E5%BB%BA%E4%B8%AA%E4%BA%BA%E5%8D%9A%E5%AE%A2Wordpress/</url>
      
        <content type="html"><![CDATA[<h2 id="docker搭建个人博客Wordpress"><a href="#docker搭建个人博客Wordpress" class="headerlink" title="docker搭建个人博客Wordpress"></a>docker搭建个人博客Wordpress</h2><h3 id="一、重裝系统"><a href="#一、重裝系统" class="headerlink" title="一、重裝系统"></a>一、重裝系统</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">bash &lt;(wget --no-check-certificate -qO- <span class="string">&#x27;https://raw.githubusercontent.com/MoeClub/Note/master/InstallNET.sh&#x27;</span>) -d 11 -v 64 -p asdasd123123 -port 22</span><br></pre></td></tr></table></figure><p>-p 后面为root密码</p><h3 id="二、更新环境"><a href="#二、更新环境" class="headerlink" title="二、更新环境"></a>二、更新环境</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">apt update -y  &amp;&amp; apt upgrade -y &amp;&amp; apt install -y curl wget <span class="built_in">sudo</span> socat</span><br></pre></td></tr></table></figure><h3 id="三、安装-Docker"><a href="#三、安装-Docker" class="headerlink" title="三、安装 Docker"></a>三、安装 Docker</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">curl -fsSL https://get.docker.com -o get-docker.sh &amp;&amp; sh get-docker.sh</span><br><span class="line">curl -L <span class="string">&quot;https://github.com/docker/compose/releases/download/v2.17.2/docker-compose-<span class="subst">$(uname -s)</span>-<span class="subst">$(uname -m)</span>&quot;</span> -o /usr/local/bin/docker-compose</span><br><span class="line"><span class="built_in">chmod</span> +x /usr/local/bin/docker-compose</span><br></pre></td></tr></table></figure><h3 id="四、创建wp目录，创建配置文件"><a href="#四、创建wp目录，创建配置文件" class="headerlink" title="四、创建wp目录，创建配置文件"></a>四、创建wp目录，创建配置文件</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cd</span> /home/ &amp;&amp; <span class="built_in">mkdir</span> wp1 &amp;&amp; <span class="built_in">cd</span> wp1 &amp;&amp; nano docker-compose.yml</span><br></pre></td></tr></table></figure><h3 id="五、搭建wp代码"><a href="#五、搭建wp代码" class="headerlink" title="五、搭建wp代码"></a>五、搭建wp代码</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br></pre></td><td class="code"><pre><span class="line">version: <span class="string">&#x27;3.8&#x27;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">services:</span><br><span class="line"></span><br><span class="line">  web:</span><br><span class="line"></span><br><span class="line">    image: nginx</span><br><span class="line"></span><br><span class="line">    ports:</span><br><span class="line"></span><br><span class="line">      - 80:80</span><br><span class="line"></span><br><span class="line">      - 443:443</span><br><span class="line"></span><br><span class="line">    volumes:</span><br><span class="line"></span><br><span class="line">      - ./nginx/nginx.conf:/etc/nginx/nginx.conf</span><br><span class="line"></span><br><span class="line">      - ./nginx/certs:/etc/nginx/certs</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">  wordpress:</span><br><span class="line"></span><br><span class="line">    image: wordpress</span><br><span class="line"></span><br><span class="line">    ports:</span><br><span class="line"></span><br><span class="line">      - 9000:80</span><br><span class="line"></span><br><span class="line">    environment:</span><br><span class="line"></span><br><span class="line">      WORDPRESS_DB_HOST: database</span><br><span class="line"></span><br><span class="line">      WORDPRESS_DB_NAME: wordpress</span><br><span class="line"></span><br><span class="line">      WORDPRESS_DB_USER: wordpress</span><br><span class="line"></span><br><span class="line">      WORDPRESS_DB_PASSWORD: kejixiaoxinwordpress_password123</span><br><span class="line"></span><br><span class="line">    volumes:</span><br><span class="line"></span><br><span class="line">      - wordpress-data:/var/www/html</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">  database:</span><br><span class="line"></span><br><span class="line">    image: mysql</span><br><span class="line"></span><br><span class="line">    <span class="comment"># image: arm64v8/mysql</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># ARM使用上面的镜像 去掉井号 同时为image: mysql加上井号    </span></span><br><span class="line"></span><br><span class="line">    environment:</span><br><span class="line"></span><br><span class="line">      MYSQL_ROOT_PASSWORD: root_password</span><br><span class="line"></span><br><span class="line">      MYSQL_DATABASE: wordpress</span><br><span class="line"></span><br><span class="line">      MYSQL_USER: wordpress</span><br><span class="line"></span><br><span class="line">      MYSQL_PASSWORD: kejixiaoxinwordpress_password123</span><br><span class="line"></span><br><span class="line">    volumes:</span><br><span class="line"></span><br><span class="line">      - mysql:/var/lib/mysql</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">volumes:</span><br><span class="line"></span><br><span class="line">  wordpress-data:</span><br><span class="line"></span><br><span class="line">  mysql:</span><br></pre></td></tr></table></figure><h3 id="六、创建nginx容器所需目录"><a href="#六、创建nginx容器所需目录" class="headerlink" title="六、创建nginx容器所需目录"></a>六、创建nginx容器所需目录</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cd</span> /home/wp1 &amp;&amp; <span class="built_in">mkdir</span> nginx &amp;&amp; <span class="built_in">cd</span> nginx &amp;&amp; <span class="built_in">mkdir</span> certs</span><br></pre></td></tr></table></figure><h3 id="七、进入目录，创建一个nginx配置文件"><a href="#七、进入目录，创建一个nginx配置文件" class="headerlink" title="七、进入目录，创建一个nginx配置文件"></a>七、进入目录，创建一个nginx配置文件</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cd</span> /home/wp1/nginx/ &amp;&amp; nano nginx.conf</span><br></pre></td></tr></table></figure><h3 id="八、搭建反代代码"><a href="#八、搭建反代代码" class="headerlink" title="八、搭建反代代码"></a>八、搭建反代代码</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line">events &#123;</span><br><span class="line"></span><br><span class="line">    worker_connections  1024;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">http &#123;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">  client_max_body_size 1000m;  </span><br><span class="line"></span><br><span class="line"></span><br><span class="line">  <span class="comment">#上传限制参数1G以内文件可上传</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">  server &#123;</span><br><span class="line"></span><br><span class="line">    listen 80;</span><br><span class="line"></span><br><span class="line">    server_name 加上自己域名;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">return</span> 301 https://$host<span class="variable">$request_uri</span>;</span><br><span class="line"></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  server &#123;</span><br><span class="line"></span><br><span class="line">    listen 443 ssl http2;</span><br><span class="line"></span><br><span class="line">    server_name 加上自己域名;</span><br><span class="line"></span><br><span class="line">    ssl_certificate /etc/nginx/certs/cert.pem;</span><br><span class="line"></span><br><span class="line">    ssl_certificate_key /etc/nginx/certs/key.pem;</span><br><span class="line"></span><br><span class="line">    location / &#123;</span><br><span class="line"></span><br><span class="line">      proxy_pass http://服务器地址:9000;</span><br><span class="line"></span><br><span class="line">      proxy_set_header Host <span class="variable">$host</span>;</span><br><span class="line"></span><br><span class="line">      proxy_set_header X-Real-IP <span class="variable">$remote_addr</span>;</span><br><span class="line"></span><br><span class="line">      proxy_set_header X-Forwarded-For <span class="variable">$proxy_add_x_forwarded_for</span>;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="九、创建SSL证书，我是用CF的15年证书"><a href="#九、创建SSL证书，我是用CF的15年证书" class="headerlink" title="九、创建SSL证书，我是用CF的15年证书"></a>九、创建SSL证书，我是用CF的15年证书</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">公钥</span><br><span class="line"><span class="built_in">cd</span> /home/wp1/nginx/certs &amp;&amp; nano cert.pem</span><br><span class="line"></span><br><span class="line">私钥</span><br><span class="line"><span class="built_in">cd</span> /home/wp1/nginx/certs &amp;&amp; nano key.pem</span><br></pre></td></tr></table></figure><h3 id="十、运行指令"><a href="#十、运行指令" class="headerlink" title="十、运行指令"></a>十、运行指令</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cd</span> /home/wp1 &amp;&amp; docker-compose up -d</span><br></pre></td></tr></table></figure><h3 id="十一、开机自启动"><a href="#十一、开机自启动" class="headerlink" title="十一、开机自启动"></a>十一、开机自启动</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker update --restart=always wp1-wordpress-1 &amp;&amp; docker update --restart=always wp1-database-1 &amp;&amp; docker update --restart=always wp1-web-1</span><br></pre></td></tr></table></figure><h3 id="十三、其他"><a href="#十三、其他" class="headerlink" title="十三、其他"></a>十三、其他</h3><p>1、备份</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cd</span> /home &amp;&amp; tar -czvf wp1.tar.gz wp1/</span><br></pre></td></tr></table></figure><p>2、迁移&amp;还原</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cd</span> /home &amp;&amp; tar xvzf wp1.tar.gz</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
    </entry>
    
    
  
  
</search>
